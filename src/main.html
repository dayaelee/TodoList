<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>오늘 할 일</title>
        <script>
            window.onload = function() {
                // 페이지 로드시 localStorage에서 값을 가져와서 출력 
                try {
                    var todo = JSON.parse(localStorage.getItem('todo')) || [];
                    displayArray(todo);
                } catch (error) {
                    console.error('Error parsing JSON from localStorage:', error.message);
                    // 이 경우에는 새로운 배열로 초기화할 수 있음
                    var todo = [];
                    displayArray(todo);
                }
            }

            function showValue() {
                var inputValue = document.getElementById('inputData').value;
                console.log('inputValue:', inputValue);
                
                // 로컬스토리지에서 'todo' 키로 저장된 배열 가져오기 
                var storedArray = JSON.parse(window.localStorage.getItem('todo')) || [];
                console.log('storedArray:', storedArray);
                
                // 입력값을 배열에 추가함
                storedArray.push(inputValue)

                // localStorage에 값을 저장 
                window.localStorage.setItem('todo', JSON.stringify(storedArray));

                // 입력 필드 초기화 
                document.getElementById('inputData').value = '';

                // 배열 화면에 출력
                displayArray(storedArray);
            }

            function displayArray(array){
                console.log('displayArray');
                var list = document.getElementById('todoList');
                list.innerHTML = ''; // 기존 리스트 초기화 

                array.forEach(function(item){
                    // 새로운 리스트 아이템 생성  
                    var listItem = document.createElement('li'); // li를 만들고 이를 참조하는 리스트 생성
                    
                    var checkbox = document.createElement('input');
                    checkbox.type = "checkbox";

                    var label = document.createElement('label');
                    label.textContent = item;

                    
                    listItem.appendChild(label)
                    listItem.appendChild(checkbox)

                    // 리스트에 추가 
                    list.appendChild(listItem);
                    
                });
            }
        </script>
    </head>
   
    <body>
        <h1> 
            오늘 할 일 
        </h1>
        <input type="text" id = "inputData"></input>
        <button type="button" onclick="showValue()">추가</button>
        <ol id="todoList">
        </ol>
    </body>
</html>